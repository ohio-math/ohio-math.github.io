<!DOCTYPE html>

<html>
  <head>
    <title>JSDelivr Exploitr v1.1</title>
    <meta charset="utf-8">
    <style>
      body {
        margin: 0;
      }
    </style>
  </head>
  <body>
    <h1>JSDelivr Exploitr v1.1</h1>
    <p><span id="url" contenteditable="true">https://purepro3000.github.io</span></p>
    <button id="b">Go</button>
    <iframe id="f" srcdoc="Pluh" style="height:85vh;width:100%"></iframe>

    <script>
      let button = document.getElementById("b");
      let frame = document.getElementById("f");

      button.onclick = () => {
        let url = document.getElementById("url").innerText;
        let base = url.split("https://")[1].split("/")[0];
        let path = new URL(url).pathname;
        var p = path.slice(1);
        if (!p.endsWith(".html")) p = p + ".html";
        if (path == ".html") p = "index.html";
        
        let checkLater = false;

        if (!/https:\/\/[a-zA-Z0-9_-]+\.github\.io(\/.*)?/.test(url)) {
          frame.srcdoc = "Invalid URL: " + url;
        } else {
          fetch(url)
          .then(response => response.text())
          .then(data => {
            frame.srcdoc = data.slice("</body>")[0] + `<script>let url = ${url}; let base = ${base}; let path = ${path};<\/script><script src='https://ohio-math.github.io/prox.js'<\/script><\/body><\/html>`;
          });
          // checkLater = true;
        }
      }
    </script>
  </body>
</html>
